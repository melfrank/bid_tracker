<?xml version="1.0" encoding="UTF-8"?><record_update table="syntax_editor_macro">
    <syntax_editor_macro action="DELETE">
        <comments>locate all form fields</comments>
        <name>find fields</name>
        <sys_class_name>syntax_editor_macro</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-05-28 20:14:17</sys_created_on>
        <sys_id>71f282f107c510109584f0269c1ed069</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>find fields</sys_name>
        <sys_package display_value="Bid Tracker" source="x_172976_bid_track">cd314385db4f7b00e55d7b1ebf96196b</sys_package>
        <sys_policy/>
        <sys_scope display_value="Bid Tracker">cd314385db4f7b00e55d7b1ebf96196b</sys_scope>
        <sys_update_name>syntax_editor_macro_71f282f107c510109584f0269c1ed069</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-05-28 20:14:17</sys_updated_on>
        <text>var duplicatedViewElementAgg = new GlideAggregate('sys_ui_element');&#13;
&#13;
&#13;
duplicatedViewElementAgg.addQuery('type', '');&#13;
&#13;
&#13;
duplicatedViewElementAgg.addQuery('sys_ui_section.name', '!=', '');&#13;
&#13;
&#13;
duplicatedViewElementAgg.groupBy('element');&#13;
&#13;
&#13;
duplicatedViewElementAgg.groupBy('sys_ui_section.name');&#13;
&#13;
&#13;
duplicatedViewElementAgg.groupBy('sys_ui_section.view');&#13;
&#13;
&#13;
duplicatedViewElementAgg.addAggregate('COUNT');&#13;
&#13;
&#13;
duplicatedViewElementAgg.addHaving('COUNT', '&gt;', '1');&#13;
&#13;
&#13;
duplicatedViewElementAgg.query();&#13;
&#13;
&#13;
&#13;
&#13;
while (duplicatedViewElementAgg.next()) {&#13;
&#13;
&#13;
     var tableName = duplicatedViewElementAgg.getValue('sys_ui_section.name');&#13;
&#13;
&#13;
     var view = duplicatedViewElementAgg.getValue('sys_ui_section.view');&#13;
&#13;
&#13;
     var element = duplicatedViewElementAgg.getValue('element');&#13;
&#13;
&#13;
&#13;
&#13;
     checkFormsForView(view, tableName, element);&#13;
&#13;
&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
function checkFormsForView(view, tableName, element) {&#13;
&#13;
&#13;
     var formGR = new GlideRecord('sys_ui_form');&#13;
&#13;
&#13;
     formGR.addQuery('name', tableName);&#13;
&#13;
&#13;
     formGR.addQuery('view', view);&#13;
&#13;
&#13;
     formGR.addQuery('sys_user', '');&#13;
&#13;
&#13;
     formGR.query();&#13;
&#13;
&#13;
&#13;
&#13;
     while (formGR.next()) {&#13;
&#13;
&#13;
           var sectionIDs = getSectionIDs(formGR);&#13;
&#13;
&#13;
&#13;
&#13;
           var hasNoSections = sectionIDs.length == 0;&#13;
&#13;
&#13;
           if (hasNoSections)&#13;
&#13;
&#13;
                 continue;&#13;
&#13;
&#13;
&#13;
&#13;
           var sectionNames = getSectionsNamesForElement(element, sectionIDs)&#13;
&#13;
&#13;
           var isInMultipleSections = sectionNames.length &gt;= 2;&#13;
&#13;
&#13;
           if (isInMultipleSections)&#13;
&#13;
&#13;
                 gs.print('DupField: ' + tableName + '.' + element + ', View: ' + view + ' (Sections: ' + sectionNames + ')');&#13;
&#13;
&#13;
     }&#13;
&#13;
&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
function getSectionsNamesForElement(element, sectionIDs) {&#13;
&#13;
&#13;
     var sectionGR = new GlideRecord('sys_ui_element');&#13;
&#13;
&#13;
     sectionGR.addQuery('element', element);&#13;
&#13;
&#13;
     sectionGR.addQuery('sys_ui_section', 'IN', sectionIDs);&#13;
&#13;
&#13;
     sectionGR.query();&#13;
&#13;
&#13;
     var captions = [];&#13;
&#13;
&#13;
&#13;
&#13;
     while (sectionGR.next()) {&#13;
&#13;
&#13;
           var sectionCaption = sectionGR.sys_ui_section.getDisplayValue();&#13;
&#13;
&#13;
           if (sectionCaption == '')&#13;
&#13;
&#13;
                 sectionCaption = 'DEFAULT'&#13;
&#13;
&#13;
&#13;
&#13;
           captions.push(sectionCaption);&#13;
&#13;
&#13;
     }&#13;
&#13;
&#13;
&#13;
&#13;
     return captions;&#13;
&#13;
&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
function getSectionIDs(formGR) {&#13;
&#13;
&#13;
     var sectionIDs = [];&#13;
&#13;
&#13;
&#13;
&#13;
     var formSectionGR = new GlideRecord('sys_ui_form_section');&#13;
&#13;
&#13;
     formSectionGR.addQuery('sys_ui_form', formGR.getUniqueValue());&#13;
&#13;
&#13;
     formSectionGR.query();&#13;
&#13;
&#13;
&#13;
&#13;
     while (formSectionGR.next()) {&#13;
&#13;
&#13;
           sectionIDs.push(formSectionGR.sys_ui_section + '');&#13;
&#13;
&#13;
     }&#13;
&#13;
&#13;
&#13;
&#13;
     return sectionIDs;&#13;
&#13;
&#13;
}&#13;
&#13;
</text>
    </syntax_editor_macro>
    <sys_update_version action="INSERT_OR_UPDATE">
        <action>DELETE</action>
        <application display_value="Bid Tracker">cd314385db4f7b00e55d7b1ebf96196b</application>
        <file_path/>
        <instance_id>f84ab18adb0ab3084d2bac44d49619de</instance_id>
        <instance_name>dev87711</instance_name>
        <name>syntax_editor_macro_71f282f107c510109584f0269c1ed069</name>
        <payload><![CDATA[<?xml version="1.0" encoding="UTF-8"?><record_update table="syntax_editor_macro"><syntax_editor_macro action="INSERT_OR_UPDATE"><comments>locate all form fields</comments><name>find fields</name><sys_class_name>syntax_editor_macro</sys_class_name><sys_created_by>admin</sys_created_by><sys_created_on>2020-05-28 20:14:17</sys_created_on><sys_id>71f282f107c510109584f0269c1ed069</sys_id><sys_mod_count>0</sys_mod_count><sys_name>find fields</sys_name><sys_package display_value="Bid Tracker" source="x_172976_bid_track">cd314385db4f7b00e55d7b1ebf96196b</sys_package><sys_policy/><sys_scope display_value="Bid Tracker">cd314385db4f7b00e55d7b1ebf96196b</sys_scope><sys_update_name>syntax_editor_macro_71f282f107c510109584f0269c1ed069</sys_update_name><sys_updated_by>admin</sys_updated_by><sys_updated_on>2020-05-28 20:14:17</sys_updated_on><text>var duplicatedViewElementAgg = new GlideAggregate('sys_ui_element');&#13;
&#13;
&#13;
duplicatedViewElementAgg.addQuery('type', '');&#13;
&#13;
&#13;
duplicatedViewElementAgg.addQuery('sys_ui_section.name', '!=', '');&#13;
&#13;
&#13;
duplicatedViewElementAgg.groupBy('element');&#13;
&#13;
&#13;
duplicatedViewElementAgg.groupBy('sys_ui_section.name');&#13;
&#13;
&#13;
duplicatedViewElementAgg.groupBy('sys_ui_section.view');&#13;
&#13;
&#13;
duplicatedViewElementAgg.addAggregate('COUNT');&#13;
&#13;
&#13;
duplicatedViewElementAgg.addHaving('COUNT', '&gt;', '1');&#13;
&#13;
&#13;
duplicatedViewElementAgg.query();&#13;
&#13;
&#13;
&#13;
&#13;
while (duplicatedViewElementAgg.next()) {&#13;
&#13;
&#13;
     var tableName = duplicatedViewElementAgg.getValue('sys_ui_section.name');&#13;
&#13;
&#13;
     var view = duplicatedViewElementAgg.getValue('sys_ui_section.view');&#13;
&#13;
&#13;
     var element = duplicatedViewElementAgg.getValue('element');&#13;
&#13;
&#13;
&#13;
&#13;
     checkFormsForView(view, tableName, element);&#13;
&#13;
&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
function checkFormsForView(view, tableName, element) {&#13;
&#13;
&#13;
     var formGR = new GlideRecord('sys_ui_form');&#13;
&#13;
&#13;
     formGR.addQuery('name', tableName);&#13;
&#13;
&#13;
     formGR.addQuery('view', view);&#13;
&#13;
&#13;
     formGR.addQuery('sys_user', '');&#13;
&#13;
&#13;
     formGR.query();&#13;
&#13;
&#13;
&#13;
&#13;
     while (formGR.next()) {&#13;
&#13;
&#13;
           var sectionIDs = getSectionIDs(formGR);&#13;
&#13;
&#13;
&#13;
&#13;
           var hasNoSections = sectionIDs.length == 0;&#13;
&#13;
&#13;
           if (hasNoSections)&#13;
&#13;
&#13;
                 continue;&#13;
&#13;
&#13;
&#13;
&#13;
           var sectionNames = getSectionsNamesForElement(element, sectionIDs)&#13;
&#13;
&#13;
           var isInMultipleSections = sectionNames.length &gt;= 2;&#13;
&#13;
&#13;
           if (isInMultipleSections)&#13;
&#13;
&#13;
                 gs.print('DupField: ' + tableName + '.' + element + ', View: ' + view + ' (Sections: ' + sectionNames + ')');&#13;
&#13;
&#13;
     }&#13;
&#13;
&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
function getSectionsNamesForElement(element, sectionIDs) {&#13;
&#13;
&#13;
     var sectionGR = new GlideRecord('sys_ui_element');&#13;
&#13;
&#13;
     sectionGR.addQuery('element', element);&#13;
&#13;
&#13;
     sectionGR.addQuery('sys_ui_section', 'IN', sectionIDs);&#13;
&#13;
&#13;
     sectionGR.query();&#13;
&#13;
&#13;
     var captions = [];&#13;
&#13;
&#13;
&#13;
&#13;
     while (sectionGR.next()) {&#13;
&#13;
&#13;
           var sectionCaption = sectionGR.sys_ui_section.getDisplayValue();&#13;
&#13;
&#13;
           if (sectionCaption == '')&#13;
&#13;
&#13;
                 sectionCaption = 'DEFAULT'&#13;
&#13;
&#13;
&#13;
&#13;
           captions.push(sectionCaption);&#13;
&#13;
&#13;
     }&#13;
&#13;
&#13;
&#13;
&#13;
     return captions;&#13;
&#13;
&#13;
}&#13;
&#13;
&#13;
&#13;
&#13;
function getSectionIDs(formGR) {&#13;
&#13;
&#13;
     var sectionIDs = [];&#13;
&#13;
&#13;
&#13;
&#13;
     var formSectionGR = new GlideRecord('sys_ui_form_section');&#13;
&#13;
&#13;
     formSectionGR.addQuery('sys_ui_form', formGR.getUniqueValue());&#13;
&#13;
&#13;
     formSectionGR.query();&#13;
&#13;
&#13;
&#13;
&#13;
     while (formSectionGR.next()) {&#13;
&#13;
&#13;
           sectionIDs.push(formSectionGR.sys_ui_section + '');&#13;
&#13;
&#13;
     }&#13;
&#13;
&#13;
&#13;
&#13;
     return sectionIDs;&#13;
&#13;
&#13;
}&#13;
&#13;
</text></syntax_editor_macro></record_update>]]></payload>
        <payload_hash>-383005720</payload_hash>
        <record_name>find fields</record_name>
        <reverted_from/>
        <source>46cd6d2707a300109584f0269c1ed05c</source>
        <source_table>sys_update_set</source_table>
        <state>previous</state>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-05-28 20:14:17</sys_created_on>
        <sys_id>2603cef107c510109584f0269c1ed047</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_recorded_at>1725cebce1c0000001</sys_recorded_at>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-05-28 20:14:17</sys_updated_on>
        <type>Editor Macro</type>
        <update_guid>6e03cef19bc51010471eaad18f9ea146</update_guid>
        <update_guid_history>6e03cef19bc51010471eaad18f9ea146:-383005720</update_guid_history>
    </sys_update_version>
    <sys_metadata_delete action="INSERT_OR_UPDATE">
        <sys_audit_delete display_value="find fields">8fd38ab107c510109584f0269c1ed0cf</sys_audit_delete>
        <sys_class_name>sys_metadata_delete</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-05-28 20:17:52</sys_created_on>
        <sys_db_object display_value="" name="syntax_editor_macro">syntax_editor_macro</sys_db_object>
        <sys_id>64404bbbb8fa4d0cb5f103e3c6b1ab10</sys_id>
        <sys_metadata>71f282f107c510109584f0269c1ed069</sys_metadata>
        <sys_mod_count>0</sys_mod_count>
        <sys_name>find fields</sys_name>
        <sys_package display_value="Bid Tracker" source="x_172976_bid_track">cd314385db4f7b00e55d7b1ebf96196b</sys_package>
        <sys_parent/>
        <sys_policy/>
        <sys_scope display_value="Bid Tracker">cd314385db4f7b00e55d7b1ebf96196b</sys_scope>
        <sys_scope_delete display_value="">634858217a1a496db7b69b0797195c91</sys_scope_delete>
        <sys_update_name>syntax_editor_macro_71f282f107c510109584f0269c1ed069</sys_update_name>
        <sys_update_version display_value="syntax_editor_macro_71f282f107c510109584f0269c1ed069">2603cef107c510109584f0269c1ed047</sys_update_version>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-05-28 20:17:52</sys_updated_on>
    </sys_metadata_delete>
</record_update>
